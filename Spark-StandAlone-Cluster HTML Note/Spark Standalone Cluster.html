<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.11 (454876)"/><meta name="altitude" content="32.52035140991211"/><meta name="author" content="wangyannhao"/><meta name="created" content="2017-06-12 19:26:31 +0000"/><meta name="latitude" content="40.52164905965788"/><meta name="longitude" content="-74.46082846641805"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2017-06-12 20:20:45 +0000"/><title>Spark Standalone Cluster</title></head><body><div><b><font style="font-size: 18px;"><br/></font></b></div><div><b><font style="font-size: 18px;">Master: </font></b></div><hr/><div>add Master ip address into SPARK_HOME/conf/spark-env.sh</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>SPARK_MASTER_HOST=172.27.2.248 # Change whatever the IP is for the Master</div></div><div><br/></div><div>start Master with following command (cd in to SPARK_HOME):</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>.sbin/start-master.sh</div></div><div><br/></div><div>In the Web UI, you should be able to see the following web page from <a href="http://127.0.0.1:8080/">localhost:8080</a>. Here, you can have an overview of the cluster. </div><div><img src="Spark%20Standalone%20Cluster.resources/A4F7BE31-6A5C-4147-8C6D-502CFA42F2B4.png" height="488" width="1214"/><br/></div><div><font size="1"><b style="font-size: 18px;"><br/></b></font></div><div><font size="1"><b style="font-size: 18px;">Slave:</b></font></div><hr/><div><font style="font-size: 14px;">start  Slave on another device using command:</font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>.sbin/start-slave.sh spark://MASTER-IP-ADDRESS:7077</div></div><div><br/></div><div>Refresh the Web UI and you should be able to see the Workers added to the cluster:</div><div><img src="Spark%20Standalone%20Cluster.resources/7E35A98A-C407-47CD-9CE3-420F35A5F32C.png" height="445" width="1226"/><br/></div><div><br/></div><div><font size="1"><b style="font-size: 18px;">Sample-Spark-Application:</b></font></div><hr/><div>We can launch Spark shell to do a simple example:</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>.bin/spark-shell —master spark://172.27.2.248:7077 # —master IP will run the shell on the master, w/o it will run locally</div></div><div><br/></div><div><img src="Spark%20Standalone%20Cluster.resources/20E9488E-4D3F-4EE2-9118-63B7891FB4AA.png" height="362" width="614"/><br/></div><div><br/></div><div>Now, if you refresh the WebUI, you can see spark-shell application being added:</div><div><img src="Spark%20Standalone%20Cluster.resources/CBD608C7-CA38-46FF-8B00-7CF9145E35B7.png" height="581" width="1213"/><br/></div><div><br/></div><div>Click into the Application ID, you can see the Event Timeline of the Spark Jobs. You can see that Executor 0 and 1 are being added respectively. </div><div><img src="Spark%20Standalone%20Cluster.resources/E868C524-4237-4DEE-B6ED-EF492267D28C.png" height="426" width="1219"/><br/></div><div><br/></div><div>The following is an example written in Scala:</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>val v1 = sc.parallelize(1 to 1000)</div><div>v1.collect()</div></div><div><br/></div><div>After executing <b>Action </b><i style="font-weight: bold;">collect()</i>, you can see detail of Job 0 as below:</div><div><img src="Spark%20Standalone%20Cluster.resources/2E6FC24E-6311-4D6D-9AAB-77B952263AAB.png" height="662" width="1226"/><br/></div><div><br/></div><div>To show the DAG visualization, we use a second example:</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;-en-codeblock:true;"><div>val v2 = sc.parallelize(1000 to 2000)</div><div>val v3 = v1.union(v2)</div><div>v3.collect()</div></div><div><br/></div><div>After this step, in <i>Details in Stage 1, </i>we can see the following:</div><div><img src="Spark%20Standalone%20Cluster.resources/FA25CC2F-9EEE-48AE-8BE5-CDF8599FFC25.png" height="670" width="1214"/><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></body></html>